<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathe Arbeitsblatt Generator - 2. Klasse</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Nunito:wght@400;700&display=swap');

        :root {
            --primary-color: #4facfe;
            --secondary-color: #00f2fe;
            --accent-color: #ff9a9e;
            --text-color: #333;
            --bg-color: #f0f4f8;
            --sheet-bg: #fff;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(120deg, var(--bg-color), #d9e2ec);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Control Panel (Screen Only) */
        .controls {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 800px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        select {
            padding: 12px 20px;
            font-size: 1rem;
            border-radius: 12px;
            border: 2px solid #ddd;
            background-color: white;
            color: var(--text-color);
            cursor: pointer;
            outline: none;
            transition: border-color 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        select:focus {
            border-color: var(--primary-color);
        }

        button {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 700;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Nunito', sans-serif;
        }

        .btn-generate {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-print {
            background: linear-gradient(135deg, var(--accent-color), #fecfef);
            color: white;
        }

        .btn-check {
            background: linear-gradient(135deg, #42e695, #3bb2b8);
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        /* Print Optimization */
        @page {
            size: A4;
            margin: 0;
            /* Let the body/sheet handle margins */
        }

        /* Worksheet (Screen Preview & Print) */
        .sheet {
            background: var(--sheet-bg);
            width: 210mm;
            min-height: 297mm;
            padding: 15mm;
            /* Reduced padding */
            box-sizing: border-box;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            font-family: 'Comic Neue', cursive;
            font-size: 16pt;
            /* Slightly smaller font */
            margin: auto;
            /* Center on screen */
        }

        .sheet-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            /* Reduced margin */
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .header-field {
            display: flex;
            align-items: baseline;
            gap: 10px;
        }

        .line {
            border-bottom: 1px solid #000;
            width: 150px;
            display: inline-block;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
            /* Reduced margin */
            font-size: 22pt;
            /* Slightly smaller */
            margin-top: 0;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            column-gap: 40px;
            row-gap: 25px;
            /* Reduced gap */
        }

        .problem {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            /* Reduced padding */
            /* border-bottom: 1px dashed #eee; */
            /* Optional guide lines */
        }

        .number {
            width: 50px;
            /* Adjusted width */
            text-align: right;
        }

        .operator {
            width: 25px;
            text-align: center;
        }

        .equals {
            width: 25px;
            text-align: center;
        }

        .answer-box {
            width: 70px;
            height: 35px;
            border: 2px solid #ccc;
            border-radius: 8px;
            background-color: #fafafa;
            display: inline-block;
            vertical-align: middle;
        }

        /* Input Styles */
        input.answer-input {
            width: 70px;
            height: 35px;
            border: 2px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            font-family: 'Comic Neue', cursive;
            font-size: 16pt;
            text-align: center;
            color: var(--text-color);
            outline: none;
            transition: all 0.3s ease;
        }

        input.answer-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 5px rgba(79, 172, 254, 0.5);
        }

        input.answer-input.correct {
            border-color: #2ecc71;
            background-color: #e8f8f5;
            color: #27ae60;
        }

        input.answer-input.incorrect {
            border-color: #e74c3c;
            background-color: #fadbd8;
            color: #c0392b;
        }

        .footer {
            position: absolute;
            /* Fix footer to bottom */
            bottom: 15mm;
            left: 0;
            width: 100%;
            text-align: center;
            color: #888;
            font-size: 10pt;
        }

        /* Motivational Emoji */
        .mascot {
            position: absolute;
            bottom: 15mm;
            /* Match footer area */
            right: 15mm;
            /* Match padding */
            font-size: 3rem;
            opacity: 0.8;
        }

        /* Rechenmauer (Pyramid) Styles */
        .pyramid-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .pyramid-row {
            display: flex;
            justify-content: center;
            gap: 5px;
            /* Gap between bricks */
        }

        .brick {
            width: 60px;
            height: 35px;
            border: 2px solid #333;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14pt;
            background-color: #fff;
            position: relative;
        }

        /* Input brick vs Fixed brick styling */
        .brick.input {
            background-color: #fafafa;
            color: transparent;
            /* Text hidden if it was there contextually, but mainly we use empty div */
        }

        /* Ensure inputs fit in bricks if we used input elements, but we might just use empty bricks for kids to write in */
        input.brick-input {
            width: 100%;
            height: 100%;
            border: none;
            text-align: center;
            font-family: inherit;
            font-size: inherit;
            background: transparent;
            color: inherit;
            outline: none;
        }

        .brick.input.correct {
            background-color: #e8f8f5;
            border-color: #2ecc71;
            color: #27ae60;
        }

        .brick.input.incorrect {
            background-color: #fadbd8;
            border-color: #e74c3c;
            color: #c0392b;
        }

        @media print {

            body,
            html {
                margin: 0;
                padding: 0;
                background: none;
                width: 210mm;
                height: 297mm;
            }

            /* Ensure pyramids don't break across pages awkwardly (though grid handles most) */
            .pyramid-container {
                page-break-inside: avoid;
            }

            .controls {
                display: none;
            }

            /* Print friendly inputs */
            input.answer-input,
            input.brick-input {
                border: 2px solid #ccc;
                /* Maintain border for writing */
                background: none;
                color: transparent;
                /* Hide user answers when printing empty sheets, but show if we want? Usually we want empty.*/
            }

            /* Actually, if user wants to print the filled sheet -> color: black. 
               If user wants to print empty sheet -> they just generate and print. 
               So Color should be black. */
            input.answer-input,
            input.brick-input {
                color: #000;
            }

            .sheet {
                box-shadow: none;
                margin: 0;
                width: 100%;
                height: 100%;
                /* Force full height */
                page-break-after: avoid;
                /* Try to avoid overflow pages */
                border: none;
            }
        }
    </style>
</head>

<body>

    <div class="controls">
        <select id="gradeSelector" onchange="updateTopicSelector()">
            <option value="1">1. Klasse</option>
            <option value="2" selected>2. Klasse</option>
            <option value="3">3. Klasse</option>
        </select>
        <select id="topicSelector">
            <!-- Options populated by JS -->
        </select>
        <button class="btn-generate" onclick="generateSheet()">‚ú® Neue Aufgaben</button>
        <button class="btn-check" onclick="checkResults()">‚úîÔ∏è Pr√ºfen</button>
        <button class="btn-print" onclick="window.print()">üñ®Ô∏è Drucken</button>
    </div>

    <div class="sheet" id="sheet">
        <div class="sheet-header">
            <div class="header-field">Name: <span class="line"></span></div>
            <div class="header-field">Datum: <span class="line"></span></div>
        </div>
        <h1 id="sheetTitle">Mathe √úbung</h1>

        <div class="problem-grid" id="problemContainer">
            <!-- Problems will be inserted here -->
        </div>

        <div class="mascot" id="mascot">ü¶ä</div>

        <div class="footer">
            Gut gemacht! &bull; Erstellt mit Antigravity
        </div>
    </div>

    <script>
        const mascots = ['ü¶ä', 'ü¶â', 'ü¶Å', 'üêº', 'üê®', 'üêØ', 'ü¶Ñ', 'ü¶ñ'];

        const GRADE_TOPICS = {
            '1': [
                { value: 'add_10', text: 'Addition bis 10' },
                { value: 'sub_10', text: 'Subtraktion bis 10' },
                { value: 'add_20_simple', text: 'Addition bis 20 (ohne Zehner√ºbergang)' },
                { value: 'sub_20_simple', text: 'Subtraktion bis 20 (ohne Zehner√ºbergang)' },
                { value: 'bonds_10', text: 'Verliebte Zahlen (bis 10)' },
                { value: 'rechenmauer_10', text: 'Kleine Rechenmauern (bis 10)' }
            ],
            '2': [
                { value: 'add_20', text: 'Addition bis 20 (mit Zehner√ºbergang)' },
                { value: 'sub_20', text: 'Subtraktion bis 20 (mit Zehner√ºbergang)' },
                { value: 'add_100_simple', text: 'Addition bis 100 (ohne Zehner√ºbergang)' },
                { value: 'add_100_carry', text: 'Addition bis 100 (mit Zehner√ºbergang)' },
                { value: 'sub_100_simple', text: 'Subtraktion bis 100 (ohne Zehner√ºbergang)' },
                { value: 'sub_100_carry', text: 'Subtraktion bis 100 (mit Zehner√ºbergang)' },
                { value: 'mult_2_5_10', text: 'Kleines 1x1 (2er, 5er, 10er)' },
                { value: 'mult_all', text: 'Kleines 1x1 (Gemischt)' },
                { value: 'div_2_5_10', text: 'Geteilt (2er, 5er, 10er)' },
                { value: 'rechenmauer', text: 'Rechenmauern (Zahlenmauern)' },
                { value: 'word_problems', text: 'Sachrechnen (Textaufgaben)' }
            ],
            '3': [
                { value: 'add_1000', text: 'Addition bis 1000' },
                { value: 'sub_1000', text: 'Subtraktion bis 1000' },
                { value: 'mult_advanced', text: 'Erweitertes 1x1 (bis 20)' }, // Or large mult placeholders
                { value: 'div_100', text: 'Division (bis 100 ohne Rest)' },
                { value: 'div_remainder', text: 'Division (mit Rest - Basis)' },
                { value: 'rechenmauer_100', text: 'Gro√üe Rechenmauern (bis 100)' }
            ]
        };

        function updateTopicSelector() {
            const grade = document.getElementById('gradeSelector').value;
            const topicSelector = document.getElementById('topicSelector');
            const topics = GRADE_TOPICS[grade];

            topicSelector.innerHTML = '';
            topics.forEach(t => {
                const opt = document.createElement('option');
                opt.value = t.value;
                opt.textContent = t.text;
                topicSelector.appendChild(opt);
            });

            // Trigger generation with new first topic
            generateSheet();
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateProblem(type) {
            let a, b, op;

            switch (type) {
                // --- GRADE 1 ---
                case 'add_10':
                    a = getRandomInt(0, 9);
                    b = getRandomInt(1, 10 - a);
                    op = '+';
                    break;
                case 'sub_10':
                    a = getRandomInt(1, 10);
                    b = getRandomInt(1, a);
                    op = '-';
                    break;
                case 'add_20_simple': // No crossing 10, e.g. 12+3
                    a = getRandomInt(10, 18); // Start at 10 to ensure teen number
                    b = getRandomInt(1, 19 - a);
                    op = '+';
                    break;
                case 'sub_20_simple': // No crossing 10, e.g. 15-3
                    a = getRandomInt(11, 19);
                    b = getRandomInt(1, a - 10); // Ensure result remains >= 10
                    op = '-';
                    break;
                case 'bonds_10': // Verliebte Zahlen: 3 + _ = 10
                    // We'll handle visual rendering in the loop, here just data
                    a = getRandomInt(0, 10);
                    return { type: 'missing_addend', a: a, sum: 10, op: '+' };

                case 'rechenmauer_10':
                    return generatePyramid(10);

                // --- GRADE 2 (Legacy + Refined) ---
                case 'add_20':
                    // Keep existing logic: random sum to 20
                    a = getRandomInt(1, 19);
                    b = getRandomInt(1, 20 - a);
                    op = '+';
                    break;
                case 'sub_20':
                    a = getRandomInt(1, 20);
                    b = getRandomInt(1, a);
                    op = '-';
                    break;
                case 'add_100_simple': // No carry
                    a = getRandomInt(1, 89);
                    {
                        let a_ones = a % 10;
                        b = getRandomInt(1, 99 - a);
                        while ((b % 10) + a_ones >= 10) {
                            b = getRandomInt(1, 99 - a);
                        }
                    }
                    op = '+';
                    break;
                case 'add_100_carry': // Forced carry
                    do {
                        a = getRandomInt(10, 89);
                        b = getRandomInt(1, 99 - a);
                    } while ((a % 10) + (b % 10) < 10);
                    op = '+';
                    break;
                case 'sub_100_simple': // No borrowing
                    a = getRandomInt(10, 99);
                    {
                        let max_b_ones = a % 10;
                        let max_b_tens = Math.floor(a / 10);
                        let b_tens = getRandomInt(0, max_b_tens);
                        let b_ones = getRandomInt(0, max_b_ones);
                        b = b_tens * 10 + b_ones;
                        if (b === 0) b = 1;
                    }
                    op = '-';
                    break;
                case 'sub_100_carry': // Forced borrowing
                    do {
                        a = getRandomInt(20, 99);
                        b = getRandomInt(1, a - 1);
                    } while ((a % 10) >= (b % 10));
                    op = '-';
                    break;
                case 'mult_2_5_10':
                    b = [2, 5, 10][getRandomInt(0, 2)];
                    a = getRandomInt(1, 10);
                    op = '√ó';
                    break;
                case 'mult_all':
                    a = getRandomInt(1, 10);
                    b = getRandomInt(1, 10);
                    op = '√ó';
                    break;
                case 'div_2_5_10':
                    {
                        let divisor = [2, 5, 10][getRandomInt(0, 2)];
                        let result = getRandomInt(1, 10);
                        a = result * divisor;
                        b = divisor;
                    }
                    op = ':';
                    break;
                case 'rechenmauer':
                    return generatePyramid(100);
                case 'word_problems':
                    // Existing word problems (could be graded too, but keeping simple for now)
                    const problems = [
                        { q: "Lisa hat 5 √Ñpfel. Sie kauft 3 dazu. Wie viele hat sie?", a: 8 },
                        { q: "Tom hat 10 Ballons. 2 fliegen weg. Wie viele bleiben?", a: 8 },
                        { q: "Eine Katze hat 4 Beine. Wie viele Beine haben 2 Katzen?", a: 8 },
                        { q: "Oma backt 12 Kekse. Sie verteilt sie an 3 Enkel. Wie viele kriegt jeder?", a: 4 },
                        { q: "Im Bus sind 5 Leute. An der Haltestelle steigen 4 ein. Wie viele sind es?", a: 9 },
                        { q: "Max hat 20 Franken. Ein Buch kostet 15. Wie viel bleibt √ºbrig?", a: 5 }
                    ];
                    return { type: 'text', ...problems[getRandomInt(0, problems.length - 1)] };

                // --- GRADE 3 ---
                case 'add_1000':
                    a = getRandomInt(100, 899);
                    b = getRandomInt(1, 999 - a);
                    op = '+';
                    break;
                case 'sub_1000':
                    a = getRandomInt(100, 999);
                    b = getRandomInt(1, a - 1);
                    op = '-';
                    break;
                case 'mult_advanced':
                    // e.g. 15 * 4
                    a = getRandomInt(11, 20);
                    b = getRandomInt(2, 6); // Keep multipliers manageable
                    op = '√ó';
                    break;
                case 'div_100':
                    {
                        // Inverse of 1x1 mixed
                        let divisor = getRandomInt(2, 9);
                        let result = getRandomInt(2, 10);
                        a = result * divisor;
                        b = divisor;
                    }
                    op = ':';
                    break;
                case 'div_remainder':
                    {
                        // a / b = result R remainder
                        let divisor = getRandomInt(2, 9);
                        let result = getRandomInt(2, 10);
                        let remainder = getRandomInt(1, divisor - 1);
                        a = (result * divisor) + remainder;
                        b = divisor;
                    }
                    op = ':';
                    return { type: 'div_remainder', a, b, op };

                case 'rechenmauer_100': // Actually same as grade 2 limit but user might want harder masking? 
                    // Let's go up to 200 for grade 3? Or just stick to 100 but maybe harder start?
                    // Standard Grade 3 adds numbers up to 1000, so pyramid sum could go higher?
                    // Defaulting to 200 top.
                    return generatePyramid(200);
            }
            return { a, b, op };
        }

        function generatePyramid(maxTop) {
            let n1, n2, n3, row2_1, row2_2, top;
            do {
                // Heuristic for base numbers relative to maxTop
                let maxBase = Math.floor(maxTop / 4);
                n1 = getRandomInt(1, maxBase);
                n2 = getRandomInt(1, maxBase);
                n3 = getRandomInt(1, maxBase);
                row2_1 = n1 + n2;
                row2_2 = n2 + n3;
                top = row2_1 + row2_2;
            } while (top > maxTop);

            let mask = [false, false, false, false, false, false];
            const patterns = [
                [5],
                [3, 4],
                [5, 4, 0],
                [5, 3, 2],
                [5, 1],
                [3, 4, 1]
            ];
            const pattern = patterns[getRandomInt(0, patterns.length - 1)];
            pattern.forEach(idx => mask[idx] = true);

            return {
                type: 'pyramid',
                values: [n1, n2, n3, row2_1, row2_2, top],
                mask: mask
            };
        }

        function generateSheet() {
            const selector = document.getElementById('topicSelector');
            const type = selector.value;
            const titleElement = document.getElementById('sheetTitle');
            const container = document.getElementById('problemContainer');
            const mascotElement = document.getElementById('mascot');

            // Set Title based on selection text
            titleElement.textContent = selector.options[selector.selectedIndex].text;

            // Clear old problems
            container.innerHTML = '';

            // Layout adjustments
            if (type.includes('rechenmauer')) {
                // Pyramids need more space
                container.style.gridTemplateColumns = '1fr 1fr';
                container.style.columnGap = '30px';
                container.style.rowGap = '40px';
            } else {
                container.style.gridTemplateColumns = '1fr 1fr';
                container.style.columnGap = '40px';
                container.style.rowGap = '25px';
            }


            // For word problems and pyramids loop count varies
            let numProblems = 20;
            if (type === 'word_problems') numProblems = 8;
            if (type.includes('rechenmauer')) numProblems = 12;

            for (let i = 0; i < numProblems; i++) {
                const problemData = generateProblem(type);

                const problemDiv = document.createElement('div');
                problemDiv.className = 'problem';

                if (problemData.type === 'text') {
                    // ... (Word problem layout code verified previously) ...
                    problemDiv.style.flexDirection = 'column';
                    problemDiv.style.alignItems = 'flex-start';
                    problemDiv.style.borderBottom = '1px solid #eee';
                    problemDiv.style.paddingBottom = '10px';
                    problemDiv.innerHTML = `
                        <div style="font-size: 14pt; margin-bottom:10px;">${problemData.q}</div>
                        <div style="display:flex; gap:10px; align-items:center; width:100%; justify-content: flex-end;">
                            <span>Antwort:</span>
                            <input type="number" class="answer-input" style="width:100px;" data-expected="${problemData.a}">
                        </div>
                    `;

                } else if (problemData.type === 'pyramid') {
                    // Render Pyramid
                    const v = problemData.values;
                    const m = problemData.mask;

                    const renderBrick = (idx) => {
                        const val = v[idx];
                        const isHidden = m[idx];
                        if (isHidden) {
                            return `<div class="brick input"><input type="number" class="brick-input answer-input" data-expected="${val}"></div>`;
                        } else {
                            return `<div class="brick">${val}</div>`;
                        }
                    };

                    problemDiv.innerHTML = `
                        <div class="pyramid-container">
                            <div class="pyramid-row">
                                ${renderBrick(5)}
                            </div>
                            <div class="pyramid-row">
                                ${renderBrick(3)}
                                ${renderBrick(4)}
                            </div>
                            <div class="pyramid-row">
                                ${renderBrick(0)}
                                ${renderBrick(1)}
                                ${renderBrick(2)}
                            </div>
                        </div>
                    `;
                    problemDiv.style.display = 'block';
                    problemDiv.style.padding = '0';

                } else if (problemData.type === 'missing_addend') {
                    // e.g. 3 + [ ] = 10
                    const { a, sum, op } = problemData;
                    // Expected is sum - a? No, problemData didn't store unknown 'b'. 
                    // Wait, logic in generateProblem for bonds_10: a = random, sum = 10. b = 10-a.
                    const expected = sum - a;

                    problemDiv.innerHTML = `
                        <span class="number">${a}</span>
                        <span class="operator">${op}</span>
                        <input type="number" class="answer-input" style="width:50px; margin:0 5px;" data-expected="${expected}">
                        <span class="equals">=</span>
                        <span class="number">${sum}</span>
                    `;

                } else if (problemData.type === 'div_remainder') {
                    // e.g. 17 : 5 = [ ] R [ ]
                    const { a, b, op } = problemData;
                    // Calc expected
                    const quotient = Math.floor(a / b);
                    const remainder = a % b;

                    problemDiv.innerHTML = `
                        <span class="number">${a}</span>
                        <span class="operator">${op}</span>
                        <span class="number">${b}</span>
                        <span class="equals">=</span>
                        <input type="number" class="answer-input" style="width:40px; margin-right:5px;" data-expected="${quotient}">
                        <span style="font-size:12pt; margin-right:5px;">R</span>
                        <input type="number" class="answer-input" style="width:40px;" data-expected="${remainder}">
                    `;

                } else {
                    // Normal Number Problem
                    const { a, b, op } = problemData;
                    let expected;
                    if (op === '+') expected = a + b;
                    else if (op === '-') expected = a - b;
                    else if (op === '√ó') expected = a * b;
                    else if (op === ':') expected = a / b;

                    problemDiv.innerHTML = `
                        <span class="number">${a}</span>
                        <span class="operator">${op}</span>
                        <span class="number">${b}</span>
                        <span class="equals">=</span>
                        <input type="number" class="answer-input" data-expected="${expected}">
                    `;
                }
                container.appendChild(problemDiv);
            }

            // Random mascot
            mascotElement.textContent = mascots[getRandomInt(0, mascots.length - 1)];
        }

        function checkResults() {
            const inputs = document.querySelectorAll('.answer-input');
            let correctCount = 0;
            let total = 0;

            inputs.forEach(input => {
                // Skip if empty? No, mark as wrong or ignore. Let's mark wrong if empty or wrong.
                total++;
                const expected = parseInt(input.dataset.expected);
                const value = parseInt(input.value);

                // For pyramids, the parent brick needs styling
                const isBrick = input.classList.contains('brick-input');
                const target = isBrick ? input.parentElement : input;

                if (!isNaN(value) && value === expected) {
                    target.classList.add('correct');
                    target.classList.remove('incorrect');
                    correctCount++;
                } else {
                    target.classList.add('incorrect');
                    target.classList.remove('correct');
                }
            });

            const mascot = document.getElementById('mascot');
            if (correctCount === total) {
                mascot.textContent = 'üéâ';
                alert(`Perfekt! Alle ${total} Aufgaben sind richtig! Super gemacht! üåü`);
            } else {
                mascot.textContent = 'ü§î';
                // Optional: Don't alert for partial, just show colors.
            }
        }

        // Initialize on load
        window.onload = function () {
            updateTopicSelector(); // This will also call generateSheet
        };
    </script>
</body>

</html>